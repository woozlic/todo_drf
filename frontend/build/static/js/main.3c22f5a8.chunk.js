(this.webpackJsonpgeekbrains_frontend=this.webpackJsonpgeekbrains_frontend||[]).push([[0],{120:function(e,t,n){},121:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(37),c=n.n(s),o=(n(120),n(62)),i=n(63),u=n(106),l=n(105),j=(n(121),n(23)),d=n.n(j),b=n(11),h=n(18),p=n(203),x=n(202),O=n(100),f=n.n(O),g=n(101),v=n.n(g),m=n(103),y=n.n(m),k=n(102),T=n.n(k),C=n(201),S=n(1),w=function(e){var t=a.a.useState(0),n=Object(b.a)(t,2),r=n[0],s=n[1];return Object(S.jsx)(C.a,{sx:{position:"fixed",bottom:0,left:0,right:0},elevation:3,children:Object(S.jsxs)(x.a,{value:r,onChange:function(e,t){s(t)},children:[Object(S.jsx)(p.a,{component:h.b,to:"/users",showLabel:!0,color:"black",label:"Users",icon:Object(S.jsx)(f.a,{})}),Object(S.jsx)(p.a,{component:h.b,to:"/projects",showLabel:!0,label:"Projects",icon:Object(S.jsx)(v.a,{})}),e.isAuthenticated()?Object(S.jsx)(p.a,{showLabel:!0,label:"Logout",onClick:function(){e.logout()},icon:Object(S.jsx)(T.a,{})}):Object(S.jsx)(p.a,{component:h.b,to:"/login",showLabel:!0,label:"Login",icon:Object(S.jsx)(y.a,{})})]})})},U=n(16),P=n(204),D=n(205),H=n(207),A=n(206),L=function(e){var t=e.getHeaders,n=Object(r.useState)({}),a=Object(b.a)(n,2),s=a[0],c=a[1],o=Object(U.g)().id;return Object(r.useEffect)((function(){var e=!0;return d.a.get("http://127.0.0.1:8000/api/users/".concat(o),{headers:t()}).then((function(t){e&&c(t.data)})).catch((function(e){console.log(e)})),function(){e=!1}}),[o,t]),Object(S.jsx)("div",{children:0!==Object.keys(s).length&&s?Object(S.jsxs)(P.a,{children:[Object(S.jsx)(D.a,{title:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(s.username)}),Object(S.jsxs)(H.a,{children:[Object(S.jsxs)(A.a,{children:["First name: ",s.firstName]}),Object(S.jsxs)(A.a,{children:["Last name: ",s.lastName]}),Object(S.jsxs)(A.a,{children:["Email: ",s.email]})]})]}):Object(S.jsx)(A.a,{children:"Can't receive profile data"})})},I=function(e){var t=e.users;return Object(S.jsxs)("div",{children:[Object(S.jsx)(A.a,{variant:"h5",sx:{textAlign:"center"},children:"Users"}),t.map((function(e){return Object(S.jsxs)(P.a,{sx:{width:"100%",marginTop:"20px"},children:[Object(S.jsx)(h.b,{to:"/users/"+e.id,children:Object(S.jsx)(D.a,{title:e.firstName+" "+e.lastName})}),Object(S.jsxs)(H.a,{children:[Object(S.jsxs)(A.a,{children:["Email: ",Object(S.jsx)(A.a,{variant:"overline",children:e.email})]}),Object(S.jsxs)(A.a,{children:["Username: ",Object(S.jsx)(A.a,{variant:"overline",children:e.username})]})]})]},e.id)}))]})},E=function(e){var t=e.location;return Object(S.jsxs)("div",{children:["Page ",t.pathname," not found"]})},F=n(3),N=n(47),R=n(208),Y=function(e){return Object(S.jsx)("div",{children:e.todo.isActive&&Object(S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.todo.text,Object(S.jsx)(R.a,{onClick:function(){return e.deleteTodo(e.todo.id)},color:"error",variant:"outlined",size:"small",children:"Delete"})]})})};var B=function(e){var t=e.projectId,n=e.getHeaders,a=e.deleteTodo,s=Object(r.useState)([]),c=Object(b.a)(s,2),o=c[0],i=c[1];return Object(r.useEffect)((function(){var e=!0,r=n();return d.a.get("http://127.0.0.1:8000/api/todos/?project=".concat(t),{headers:r}).then((function(t){e&&i(t.data.results)})).catch((function(e){console.log(e)})),function(){e=!1}}),[t,n]),Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Todos:"}),o&&o.map((function(e){return Object(S.jsx)(Y,{todo:e,deleteTodo:a},e.url)}))]})},z=n(209),J=n(196),M=n(198),_=function(e){var t=e.users,n=e.getHeaders,a=e.deleteProject,s=e.createTodo,c=e.deleteTodo,o=Object(r.useState)({}),i=Object(b.a)(o,2),u=i[0],l=i[1],j=Object(r.useState)(!1),p=Object(b.a)(j,2),x=p[0],O=p[1],f=Object(r.useState)({user:"",text:""}),g=Object(b.a)(f,2),v=g[0],m=g[1],y=Object(U.g)().id;Object(r.useEffect)((function(){var e=!0;return d.a.get("http://127.0.0.1:8000/api/projects/".concat(y),{headers:n()}).then((function(t){e&&l(t.data)})).catch((function(e){console.log(e)})),function(){e=!1}}),[y,n]);var k=function(e){e.preventDefault(),m((function(t){return Object(N.a)(Object(N.a)({},t),{},Object(F.a)({},e.target.name,e.target.value))}))};return Object(S.jsx)(P.a,{children:u.users?Object(S.jsxs)("div",{children:[Object(S.jsx)(h.b,{to:"/projects/"+u.id,children:Object(S.jsx)(D.a,{title:u.title,subheader:Object(S.jsx)(R.a,{onClick:function(){return a(u.id)},sx:{marginTop:"10px"},variant:"contained",color:"error",children:"Delete project"})})}),Object(S.jsxs)(H.a,{children:[Object(S.jsxs)("p",{children:["Repository: ",Object(S.jsx)("a",{href:u.repositoryUrl,children:u.repositoryUrl})]}),Object(S.jsxs)("div",{children:["Users: ",u.users.map((function(e){return Object(S.jsx)("p",{children:Object(S.jsx)(h.b,{to:"/users/"+e,children:t.filter((function(t){return t.id===e}))[0]&&t.filter((function(t){return t.id===e}))[0].username})},e)}))]}),Object(S.jsx)(B,{deleteTodo:c,getHeaders:n,projectId:u.id},u.id),x?Object(S.jsxs)(z.a,{className:"form",margin:"dense",children:[Object(S.jsx)(J.a,{sx:{marginTop:"15px"},select:!0,name:"user",id:"user",variant:"outlined",label:"User owner",SelectProps:{value:v.user,onChange:k},children:u.users.map((function(e){return Object(S.jsx)(M.a,{value:e,children:t.filter((function(t){return t.id===e}))[0]&&t.filter((function(t){return t.id===e}))[0].username},e)}))}),Object(S.jsx)(J.a,{id:"outlined-basic",onChange:k,value:v.text,name:"text",label:"Text",variant:"outlined",sx:{marginTop:"15px"}}),Object(S.jsx)(R.a,{variant:"outlined",onClick:function(){return s(u.id,v.user,v.text)},sx:{marginTop:"15px"},children:"Create TODO"})]}):Object(S.jsx)(R.a,{sx:{marginTop:"10px"},onClick:function(){return O(!0)},variant:"contained",children:"Add TODO"})]})]}):Object(S.jsx)("div",{children:"Can't receive project's data"})})},W=function(e){var t=e.users,n=e.projects,a=e.deleteProject,s=Object(r.useState)(""),c=Object(b.a)(s,2),o=c[0],i=c[1],u=Object(r.useState)([]),l=Object(b.a)(u,2),j=l[0],d=l[1],p=Object(r.useState)(!1),x=Object(b.a)(p,2),O=x[0],f=x[1];return Object(r.useEffect)((function(){O||d(n),f(!0)}),[O]),Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(S.jsx)(J.a,{sx:{marginTop:"15px",marginBottom:"15px",width:"100%"},id:"search",label:"Search...",type:"search",onChange:function(e){i(e.target.value)}}),Object(S.jsx)(R.a,{onClick:function(e){return function(e){d(n.filter((function(e){return e.title.includes(o)}))),e.preventDefault()}(e)},children:"Search"})]}),Object(S.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(S.jsx)(A.a,{variant:"h5",sx:{padding:"10px"},children:"Projects"}),Object(S.jsx)(R.a,{component:h.b,to:"/projects/create/",variant:"contained",children:"Create new project"})]}),j.map((function(e){return Object(S.jsxs)(P.a,{sx:{width:"100%",marginTop:"20px"},children:[Object(S.jsx)(D.a,{title:Object(S.jsx)(h.b,{to:"/projects/"+e.id,children:e.title}),subheader:Object(S.jsx)(R.a,{onClick:function(){return a(e.id)},sx:{marginTop:"10px"},variant:"contained",color:"error",children:"Delete project"})}),Object(S.jsxs)(H.a,{children:[Object(S.jsxs)(A.a,{children:["Repository: ",Object(S.jsx)(A.a,{variant:"overline",children:Object(S.jsx)("a",{href:e.repositoryUrl,children:e.repositoryUrl})})]}),Object(S.jsx)(A.a,{children:"Users:"}),e.users.map((function(e){return Object(S.jsx)("div",{children:Object(S.jsx)(A.a,{variant:"overline",children:Object(S.jsx)(h.b,{to:"/users/"+e,children:t.filter((function(t){return t.id===e}))[0]&&t.filter((function(t){return t.id===e}))[0].username})})},e)}))]})]},e.id)}))]})},q=n(200);function G(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(""),o=Object(b.a)(c,2),i=o[0],u=o[1];function l(e){"username"===e.target.name?s(e.target.value):"password"===e.target.name&&u(e.target.value)}return Object(S.jsxs)(P.a,{children:[e.isAuthenticated()&&Object(S.jsx)(U.a,{to:"/"}),Object(S.jsx)(H.a,{children:Object(S.jsxs)(q.a,{component:"form",onSubmit:function(t){return function(t){e.getToken(a,i),t.preventDefault()}(t)},children:[Object(S.jsx)(q.a,{container:!0,justifyContent:"center",children:Object(S.jsx)(H.a,{children:Object(S.jsx)(J.a,{id:"outlined-basic",label:"Username",type:"username",name:"username",value:a,onChange:function(e){return l(e)}})})}),Object(S.jsx)(q.a,{container:!0,justifyContent:"center",children:Object(S.jsx)(H.a,{children:Object(S.jsx)(J.a,{id:"outlined-password-input",label:"Password",type:"password",name:"password",autoComplete:"current-password",value:i,onChange:function(e){return l(e)}})})}),Object(S.jsx)(q.a,{container:!0,justifyContent:"center",children:Object(S.jsx)(R.a,{type:"submit",variant:"contained",style:{margin:"0 auto"},children:"Login"})})]})})]})}var K=n(210);function Q(e){var t=e.createProject,n=e.users,r=a.a.useState({title:"",repositoryUrl:"",users:[]}),s=Object(b.a)(r,2),c=s[0],o=s[1],i=function(e){e.preventDefault(),o((function(t){return Object(N.a)(Object(N.a)({},t),{},Object(F.a)({},e.target.name,"checkbox"===e.target.type?e.target.checked:e.target.value))}))};return Object(S.jsxs)(z.a,{className:"form",margin:"dense",children:[Object(S.jsx)(A.a,{variant:"h5",sx:{textAlign:"center"},children:"Create new project"}),Object(S.jsx)(J.a,{id:"outlined-basic",onChange:i,value:c.title,name:"title",label:"Title",variant:"outlined",sx:{marginTop:"5px"}}),Object(S.jsx)(J.a,{id:"outlined-basic",onChange:i,value:c.repositoryUrl,name:"repositoryUrl",label:"Repository url",sx:{marginTop:"15px"},variant:"outlined"}),Object(S.jsx)(J.a,{sx:{marginTop:"15px"},select:!0,name:"users",id:"users",variant:"outlined",label:"Users",SelectProps:{multiple:!0,value:c.users,onChange:i},children:n.map((function(e){return Object(S.jsx)(M.a,{value:e.id,children:e.username},e.id)}))}),Object(S.jsx)(R.a,{onClick:function(){t(c.title,c.repositoryUrl,c.users)},sx:{marginTop:"10px"},variant:"contained",children:"Create"})]})}function V(){return Object(S.jsx)(J.a,{id:"outlined-basic",label:"Outlined",variant:"outlined"})}var X=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={users:[],projects:[],token:null,username:""},r}return Object(i.a)(n,[{key:"getToken",value:function(e,t){var n=this;d.a.post("http://127.0.0.1:8000/api-token-auth/",{username:e,password:t}).then((function(t){n.setState({username:e}),localStorage.setItem("username",e),n.setToken(t.data.token)})).catch((function(e){console.log(e),alert("Wrong password or username!")}))}},{key:"getHeaders",value:function(){var e={"Content-type":"application/json"};return this.isAuthenticated()&&(e.Authorization="Token "+this.state.token),e}},{key:"createTodo",value:function(e,t,n){var r=this,a=this.getHeaders(),s={project:"http://127.0.0.1:8000/api/projects/".concat(e,"/"),userOwner:"http://127.0.0.1:8000/api/users/".concat(+t,"/"),text:n,isActive:!0};d.a.post("http://127.0.0.1:8000/api/todos/",s,{headers:a}).then((function(e){201===e.status&&(alert("Todo successfully created"),r.loadData())})).catch((function(e){console.log(e),403===e.response.status&&alert("You have to login in order to add todos")}))}},{key:"setToken",value:function(e){var t=this;localStorage.setItem("token",e),this.setState({token:e},(function(){return t.loadData()}))}},{key:"getTokenFromStorage",value:function(){var e=this,t=localStorage.getItem("token"),n=localStorage.getItem("username");this.setState({token:t,username:n},(function(){return e.loadData()}))}},{key:"isAuthenticated",value:function(){return!!this.state.token}},{key:"getUsername",value:function(){return this.state.username}},{key:"logout",value:function(){this.setToken("")}},{key:"loadData",value:function(){var e=this,t=this.getHeaders();d.a.get("http://127.0.0.1:8000/api/users/",{headers:t}).then((function(t){e.setState({users:t.data.results})})).catch((function(t){e.setState({users:[]}),console.log(t)})),d.a.get("http://127.0.0.1:8000/api/projects/",{headers:t}).then((function(t){e.setState({projects:t.data.results})})).catch((function(t){e.setState({projects:[]}),console.log(t)}))}},{key:"createProject",value:function(e,t,n){var r=this;console.log(e,t,n);var a={title:e,repositoryUrl:t,users:n,todos:[]},s=this.getHeaders();d.a.post("http://127.0.0.1:8000/api/projects/",a,{headers:s}).then((function(e){201===e.status&&(alert("Project successfully created!"),r.loadData())})).catch((function(e){if(e.response.data){console.log(e.response.data);var t=e.response.data.title&&"Title: "+e.response.data.title.join("\n"),n=e.response.data.repositoryUrl&&"Repository Url: "+e.response.data.repositoryUrl.join("\n"),r=e.response.data.users&&"Users: "+e.response.data.users.join("\n");t&&alert(t),n&&alert(n),r&&alert(r)}403===e.response.status&&alert("You have to login in order to create project")}))}},{key:"deleteTodo",value:function(e){var t=this,n=this.getHeaders();d.a.delete("http://127.0.0.1:8000/api/todos/".concat(e),{headers:n}).then((function(e){204===e.status&&t.loadData()})).catch((function(e){console.log(e),e&&alert("You have to login in order to delete todos")}))}},{key:"deleteProject",value:function(e){var t=this,n=this.getHeaders();d.a.delete("http://127.0.0.1:8000/api/projects/".concat(e),{headers:n}).then((function(e){console.log(e),204===e.status&&(alert("Project deleted!"),t.loadData())})).catch((function(e){console.log("a "+e),e&&alert("You have to login in order to delete projects")}))}},{key:"componentDidMount",value:function(){this.getTokenFromStorage()}},{key:"render",value:function(){var e=this;return Object(S.jsx)(K.a,{sx:{display:"flex",justifyContent:"center",pb:8},children:Object(S.jsxs)(h.a,{children:[Object(S.jsxs)(U.d,{children:[Object(S.jsx)(U.b,{exact:!0,path:"/",render:function(){return Object(S.jsx)(U.a,{to:"/projects"})}}),Object(S.jsx)(U.b,{exact:!0,path:"/users",component:function(){return Object(S.jsx)(I,{users:e.state.users})}}),Object(S.jsx)(U.b,{exact:!0,path:"/projects",component:function(){return Object(S.jsx)(W,{deleteProject:e.deleteProject.bind(e),users:e.state.users,projects:e.state.projects,getHeaders:e.getHeaders.bind(e)})}}),Object(S.jsx)(U.b,{exact:!0,path:"/login",component:function(){return Object(S.jsx)(G,{getToken:function(t,n){e.getToken(t,n)},isAuthenticated:e.isAuthenticated.bind(e)})}}),Object(S.jsx)(U.b,{path:"/projects/create",component:function(){return Object(S.jsx)(Q,{createProject:function(t,n,r){return e.createProject(t,n,r)},users:e.state.users})}}),Object(S.jsx)(U.b,{path:"/todos/create",component:function(){return Object(S.jsx)(V,{})}}),Object(S.jsx)(U.b,{path:"/projects/:id",component:function(){return Object(S.jsx)(_,{deleteTodo:e.deleteTodo.bind(e),createTodo:e.createTodo.bind(e),deleteProject:e.deleteProject.bind(e),users:e.state.users,getHeaders:e.getHeaders.bind(e)})}}),Object(S.jsx)(U.b,{path:"/users/:id",component:function(){return Object(S.jsx)(L,{getHeaders:e.getHeaders.bind(e)})}}),Object(S.jsx)(U.b,{component:E})]}),Object(S.jsx)(w,{isAuthenticated:this.isAuthenticated.bind(this),logout:function(){e.logout()},getUsername:this.getUsername.bind(this)})]})})}}]),n}(a.a.Component),Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,211)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};c.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(X,{})}),document.getElementById("root")),Z()}},[[153,1,2]]]);
//# sourceMappingURL=main.3c22f5a8.chunk.js.map